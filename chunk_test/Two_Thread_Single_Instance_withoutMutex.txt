(whisper_testing) sagar.jain@GSLAB.COM@GS-6117:~/Documents/openAIWisper_POC/whisper_testing_tool/chunk_test$ python3 Two_thread_Single_Instace.py test.wav 3
Splitting audio file: test.wav with chunk size: 3s
Thread 1: Started.
Thread 1: Processing chunk 0...
Thread 2: Started.
Thread 2: Processing chunk 1...
Exception in thread Thread-2 (worker):
Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/chunk_test/Two_thread_Single_Instace.py", line 81, in worker
    result = process_chunk(model, chunk, lock)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/chunk_test/Two_thread_Single_Instace.py", line 42, in process_chunk
    result = model.transcribe(audio_np, fp16=False)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/transcribe.py", line 279, in transcribe
    result: DecodingResult = decode_with_fallback(mel_segment)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/transcribe.py", line 195, in decode_with_fallback
    decode_result = model.decode(segment, options)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/decoding.py", line 824, in decode
    result = DecodingTask(model, options).run(mel)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/decoding.py", line 737, in run
    tokens, sum_logprobs, no_speech_probs = self._main_loop(audio_features, tokens)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/decoding.py", line 687, in _main_loop
    logits = self.inference.logits(tokens, audio_features)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/decoding.py", line 163, in logits
    return self.model.decoder(tokens, audio_features, kv_cache=self.kv_cache)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/model.py", line 242, in forward
    x = block(x, xa, mask=self.mask, kv_cache=kv_cache)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/model.py", line 169, in forward
    x = x + self.cross_attn(self.cross_attn_ln(x), xa, kv_cache=kv_cache)[0]
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/sagar.jain@GSLAB.COM/Documents/openAIWisper_POC/whisper_testing_tool/whisper_testing/lib/python3.10/site-packages/whisper/model.py", line 109, in forward
    v = kv_cache[self.value]
KeyError: Linear(in_features=1024, out_features=1024, bias=True)
Thread 1: Processing chunk 2...
Thread 1: Processing chunk 3...
Thread 1: Processing chunk 4...
Thread 1: Processing chunk 5...
Thread 1: Processing chunk 6...
Thread 1: Processing chunk 7...
Thread 1: Processing chunk 8...
Thread 1: Processing chunk 9...
Thread 1: Processing chunk 10...
Thread 1: Processing chunk 11...
Thread 1: Processing chunk 12...
Thread 1: Processing chunk 13...
Thread 1: Processing chunk 14...
Thread 1: Processing chunk 15...
Thread 1: Processing chunk 16...
Thread 1: Processing chunk 17...
Thread 1: Processing chunk 18...
Thread 1: Processing chunk 19...
Thread 1: Processing chunk 20...
Thread 1: Processing chunk 21...
Thread 1: Processing chunk 22...
Thread 1: Processing chunk 23...
Thread 1: Processing chunk 24...
Thread 1: Processing chunk 25...
Thread 1: Processing chunk 26...
Thread 1: Processing chunk 27...
Thread 1: Processing chunk 28...
Thread 1: Processing chunk 29...
Thread 1: Processing chunk 30...
Thread 1: Processing chunk 31...
Thread 1: Processing chunk 32...
Thread 1: Processing chunk 33...
Thread 1: Processing chunk 34...
Thread 1: Processing chunk 35...
Thread 1: Processing chunk 36...
Thread 1: Processing chunk 37...
Thread 1: Processing chunk 38...
Thread 1: Processing chunk 39...
Thread 1: Processing chunk 40...
Thread 1: Processing chunk 41...
Thread 1: Processing chunk 42...
Thread 1: Processing chunk 43...
Thread 1: Processing chunk 44...
Thread 1: Processing chunk 45...
Thread 1: Processing chunk 46...
Thread 1: Processing chunk 47...
Thread 1: Processing chunk 48...
Thread 1: Processing chunk 49...
Thread 1: Processing chunk 50...
Thread 1: Processing chunk 51...
Thread 1: Processing chunk 52...
Thread 1: Processing chunk 53...
Thread 1: Processing chunk 54...
Thread 1: Processing chunk 55...
